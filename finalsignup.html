<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sign Up Form</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/aos.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">

    <!-- Font Icon -->
    <link rel="stylesheet" href="fonts/material-icon/css/material-design-iconic-font.min.css">

    <!-- Main css -->
    <link rel="stylesheet" href="css/signupstyle.css">
    <link rel="stylesheet" href="css/Main_style.css">

</head>
<body>

    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="index.html">
               <i class="fa fa-ravelry" aria-hidden="true"></i>
             <!-- <i class="fa fa-microphone"></i> -->
               <nbsp>MeetCummins</nbsp>
            </a>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="/" class="nav-link smoothScroll">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="#project" class="nav-link smoothScroll">Our features</a>
                    </li>
                    <li class="nav-item">
                        <a href="/blog" class="nav-link">Blog</a>
                    </li>
                    <!-- <li class="nav-item">
                        <a href="Quiz_Demo.html" class="nav-link ">Quiz</a>
                    </li>
                    <li class="nav-item">
                         <a href="Hangman.html" class="nav-link ">Hangman</a>
                     </li>
                     <li class="nav-item">
                         <a href="project-detail.html" class="nav-link ">Podcast</a>
                     </li> -->

                    <li class="nav-item">
                         <a href="contact.html" class="nav-link ">Contact</a>

                    </li>
                    <li class="nav-item">
                         <a href="loginEx.html" class="nav-link contact">Log In</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="main" style="padding-top: 50px;">

        <!-- Sign up form -->
        <section class="signup">
            <div class="containersign">
                <div class="signup-content" style="margin-top: 0px; margin-bottom: 0px;">
                    <div class="signup-form">
                        <h2 class="form-title" style="font-size: 20px">Register and Login Here!</h2>
                        <form class="register-form" id="register-form">
                            <div class="form-group">
                                <label for="name"><i class="zmdi zmdi-account material-icons-name"></i></label>
                                <input type="text" name="name" id="name" placeholder="Your Name"/>
                            </div>
                            <div class="form-group">
                                <label for="email"><i class="zmdi zmdi-email"></i></label>
                                <input type="email" name="email" id="username" placeholder="Email"/>
                            </div>
                            <div class="form-group">
                                <label for="pass"><i class="zmdi zmdi-lock"></i></label>
                                <input type="password" name="pass" id="pass" placeholder="Password"/>
                            </div>
                            <!-- <div class="form-group">
                                <label for="cpass"><i class="zmdi zmdi-lock"></i></label>
                                <input type="password" name="cpass" id="cpass" placeholder="Confirm Password"/>
                            </div> -->
                            <div class="form-group">
                                <label for="alink"><i class="zmdi zmdi-account material-icons-name"></i></label>
                                <input type="url" name="alink" id="alink" placeholder="Avatar Link"/>
                            </div>
                            <!-- <div class="form-group">
                                <label for="re-pass"><i class="zmdi zmdi-lock-outline"></i></label>
                                <input type="password" name="re_pass" id="re_pass" placeholder="Repeat your password"/>
                            </div> -->
                            <!-- <div class="form-group">
                                <input type="checkbox" name="agree-term" id="agree-term" class="agree-term" />
                                <label for="agree-term" class="label-agree-term"><span><span></span></span>I agree all statements in  <a href="#" class="term-service">Terms of service</a></label>
                            </div> -->
                            <div class="form-group form-button">
                                <button style="display: inline-block;
                                border-color: #6dabe4;
                                background: #6dabe4;
                                color: #fff;
                                border-bottom: none;
                                width: auto;
                                padding: 15px 39px;
                                border-radius: 5px;
                                -moz-border-radius: 5px;
                                -webkit-border-radius: 5px;
                                -o-border-radius: 5px;
                                -ms-border-radius: 5px;
                                margin-top: 25px;
                                cursor: pointer;" type="button" id="submitData" name="submitData" class="registerbtn">Register</button>
                                <button style="display: inline-block;
                                border-color: #6dabe4;
                                background: #6dabe4;
                                color: #fff;
                                border-bottom: none;
                                width: auto;
                                padding: 15px 39px;
                                border-radius: 5px;
                                -moz-border-radius: 5px;
                                -webkit-border-radius: 5px;
                                -o-border-radius: 5px;
                                -ms-border-radius: 5px;
                                margin-top: 25px;
                                cursor: pointer;" type="button" id="loginBtn" name="loginBtn" class="registerbtn">Login</button>
                            </div>
                        </form>
                    </div>
                    <div class="signup-image">
                        <figure><img src="images/signup-image.jpg" alt="sing up image"></figure>
                        <!-- <a href="loginEx.html" class="signup-image-link">I am already member</a> -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Sing in  Form -->
        <section class="sign-in">
            <div class="containersign">
                <div class="signin-content">
                    <div class="signin-image">
                        <figure><img src="images/signin-image.jpg" alt="sing up image"></figure>
                        <!-- <a href="/#" class="signup-image-link">Create an account</a> -->
                    </div>

                    <div class="signin-form">
                        <h2 class="form-title">Don't have an avatar yet?</h2>
                        <!-- <form method="POST" class="register-form" id="login-form">
                            <div class="form-group">
                                <label for="your_name"><i class="zmdi zmdi-account material-icons-name"></i></label>
                                <input type="text" name="your_name" id="your_name" placeholder="Your Name"/>
                            </div>
                            <div class="form-group">
                                <label for="your_pass"><i class="zmdi zmdi-lock"></i></label>
                                <input type="password" name="your_pass" id="your_pass" placeholder="Password"/>
                            </div>
                            <div class="form-group">
                                <input type="checkbox" name="remember-me" id="remember-me" class="agree-term" />
                                <label for="remember-me" class="label-agree-term"><span><span></span></span>Remember me</label>
                            </div>
                            <div class="form-group form-button">
                                <input type="submit" name="signin" id="signin" class="form-submit" value="Log in"/>
                            </div>
                        </form> -->
                        <!-- <div class="social-login">
                            <span class="social-label">Or login with</span>
                            <ul class="socials">
                                <li><a href="#"><i class="display-flex-center zmdi zmdi-facebook"></i></a></li>
                                <li><a href="#"><i class="display-flex-center zmdi zmdi-twitter"></i></a></li>
                                <li><a href="#"><i class="display-flex-center zmdi zmdi-google"></i></a></li>
                            </ul>
                        </div> -->
                        <div class="form-group form-button">
                            <a href="readyme.html"><input type="submit" name="signin" id="signin" class="form-submit" value="Create Avatar!"/></a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </div>
    <footer class="site-footer">
        <div class="container">
          <div class="row">
  
            <div class="col-lg-5 mx-lg-auto col-md-8 col-10">
              <h1 class="text-white" data-aos="fade-up" data-aos-delay="100">Join us into <strong>METAVERSE </strong></h1>
            </div>
  
            <div class="col-lg-3 col-md-6 col-12" data-aos="fade-up" data-aos-delay="200">
              <h4 class="my-4">Contact Info</h4>
  
              <p class="mb-1">
                <i class="fa fa-phone mr-2 footer-icon"></i> 
                +91 080 070 4224
              </p>
  
              <p>
                <a href="#">
                  <i class="fa fa-envelope mr-2 footer-icon"></i>
                  hello@company.com
                </a>
              </p>
            </div>
  
            <div class="col-lg-3 col-md-6 col-12" data-aos="fade-up" data-aos-delay="300">
              <h4 class="my-4">METAVERSE SERVICES</h4>
  
              <p class="mb-1">
                 <a href="#">Pricing</a>
                 <a href="#"><br>Enterprise Solution</a>
                 <!-- <a href="#"><br>Private Podcast</a>
                 <a href="#"><br>The Podcast App</a> -->
              </p>
            </div>
  
            <div class="col-lg-4 mx-lg-auto text-center col-md-8 col-12" data-aos="fade-up" data-aos-delay="400">
              <p class="copyright-text">Copyright &copy; 2022 Avalon
              <br>
              
            </div>
  
            <div class="col-lg-4 mx-lg-auto col-md-6 col-12" data-aos="fade-up" data-aos-delay="500">
              
              <ul class="footer-link">
                <li><a href="#">Stories</a></li>
                <li><a href="#">Work with us</a></li>
                <li><a href="#">Privacy</a></li>
              </ul>
            </div>
  
            <div class="col-lg-3 mx-lg-auto col-md-6 col-12" data-aos="fade-up" data-aos-delay="600">
              <ul class="social-icon">
                <li><a href="#" class="fa fa-instagram"></a></li>
                <li><a href="#" class="fa fa-twitter"></a></li>
                <li><a href="#" class="fa fa-facebook-square"></a></li>
                <li><a href="#" class="fa fa-spotify"></a></li>
              </ul>
            </div>
  
          </div>
        </div>
      </footer>
  
       <!-- SCRIPTS -->
       <script src="js/jquery.min.js"></script>
       <script src="js/bootstrap.min.js"></script>
       <script src="js/aos.js"></script>
       <script src="js/owl.carousel.min.js"></script>
       <script src="js/smoothscroll.js"></script>
       <script src="js/custom.js"></script>

    <!-- JS -->
    <script src="signupfiles/jquery.min.js"></script>
    <script src="js/main.js"></script>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.20.0/firebase-app.js";
   
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut
        } from "https://www.gstatic.com/firebasejs/9.20.0/firebase-auth.js";
        import {getDatabase, set, ref, update} from "https://www.gstatic.com/firebasejs/9.20.0/firebase-database.js";


        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC0HSSShP242v15hEMXEwyB9Oyg7sVQqz0",
            authDomain: "meetcumminsdb.firebaseapp.com",
            projectId: "meetcumminsdb",
            storageBucket: "meetcumminsdb.appspot.com",
            messagingSenderId: "292295566000",
            appId: "1:292295566000:web:f25eda3726695854f29175",
            measurementId: "G-5LESNWHCEJ"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const database = getDatabase(app);

        //var db = app.database().ref('users');
        
        function validateForm(){
                var returnval = true;

                //perform validation and if validation fails, set the value of returnval to false
                var name = document.forms['register-form']["name"].value;
                if (name.length<5){
                    alert("*Length of name is too short");
                    returnval = false;
                }

                var email = document.forms['register-form']["username"].value;
                if (email.length>30){
                    alert("*Email length is too long");
                    returnval = false;
                }

                var password = document.forms['register-form']["pass"].value;
                if (password.length < 8){
                    alert("*Password should be atleast 8 characters long!");
                    returnval = false;
                }
                if (password.search(/[A-Z]/) < 0) {
                    alert("Your password must contain at least one capital letter.");
                    returnval = false;
                }
                if (password.search(/[0-9]/) < 0) {
                    alert("Your password must contain at least one digit."); 
                    returnval = false;
                }

                // var cpassword = document.forms['register-form']["cpass"].value;
                // if (cpassword != password){
                //     alert("*Password and Confirm password should match!");
                //     returnval = false;
                // }
                //console.log('validation ' + returnval);
                return returnval;
        };
      
            submitData.addEventListener('click',(e) => {

            //console.log('validation ' + returnval);

            if(validateForm()){

                //var name = document.getElementById('name').value;
                var email = document.getElementById('username').value;
                console.log(email);
                var password = document.getElementById('pass').value;
                //var alink = document.getElementById('alink').value;

                //sign up user
                createUserWithEmailAndPassword(auth, email, password)
                    .then((userCredential) => {
                        // Signed in
                        //console.log("Hi");
                        const user = userCredential.user;
                        //console.log(userCredential.user);
                        //console.log(user);
                        // ... user.uid
                        // set(ref(database, 'users/' + user.uid), {
                        //     name: name,
                        //     alink: alink,
                        //     email: email,
                        //     password: password,
                        // })
                        //     .then(() => {
                        //         // Data saved successfully!
                        //         alert('user created successfully');
                        //     })
                        //     .catch((error) => {
                        //         // The write failed...
                        //         alert(error);
                        //     });
                    })
                    .then(() => {
                        // Data saved successfully!
                        alert('user created successfully');
                        location.reload();
                    })
                    .catch((error) => {
                        const errorCode = error.code;
                        const errorMessage = error.message;
                        // ..
                        alert(errorMessage);
                    });
                }

                app.auth().onAuthStateChanged(user =>{
                    if (user) {
                        // User is signed in.
                        console.log(user);
                        // ...
                    } else {
                        // User is signed out.
                        // ...
                    }
                 });

            });  

            
            loginBtn.addEventListener('click',(e) => {

            //console.log('validation ' + returnval);`

                var email = document.getElementById('username').value;
                console.log(email);
                var password = document.getElementById('pass').value;
                //var alink = document.getElementById('alink').value;

                //sign up user
                // createUserWithEmailAndPassword(auth, email, password)
                //     .then((userCredential) => {
                //         // Signed in
                //         //console.log("Hi");
                //         const user = userCredential.user;
                //         console.log(userCredential.user);
                //         //console.log(user);
                //         // ... user.uid
                //         // set(ref(database, 'users/' + user.uid), {
                //         //     email: email,
                //         //     password: password,
                //         //     alink: alink
                //         // })
                //         //     .then(() => {
                //         //         // Data saved successfully!
                //         //         alert('user created successfully');
                //         //     })
                //         //     .catch((error) => {
                //         //         // The write failed...
                //         //         alert(error);
                //         //     });
                //     })
                //     .then(() => {
                //                 // Data saved successfully!
                //                 alert('user created successfully');
                //     })
                //     .catch((error) => {
                //         const errorCode = error.code;
                //         const errorMessage = error.message;
                //         // ..
                //         alert(errorMessage);
                //     });

                // }

                signInWithEmailAndPassword(auth, email, password)
                    .then((userCredential) => {
                        // Signed in
                        console.log("Hi");
                        const user = userCredential.user;
                        console.log(user);
                        //console.log(user);
                        // ... user.uid
                        // set(ref(database, 'users/' + user.uid), {
                        //     email: email,
                        //     password: password,
                        //     alink: alink
                        // })
                        //     .then(() => {
                        //         // Data saved successfully!
                        //         alert('user created successfully');
                        //     })
                        //     .catch((error) => {
                        //         // The write failed...
                        //         alert(error);
                        //     });
                    })
                    .then(() => {
                                // Data saved successfully!
                                alert('user login successful!');
                                location.href = "C:/Users/HP/Documents/EK AARKHRI SEM/Project/Login System/Scratch/index.html";
                                // function preventBack(){window.history.forward();}
                                // setTimeout("preventBack()", 0);
                                // window.onunload=function(){null};
                    })
                    .catch((error) => {
                        const errorCode = error.code;
                        const errorMessage = error.message;
                        // ..
                        alert(errorMessage);
                    });

            app.auth().onAuthStateChanged(user =>{
                if (user) {
                    // User is signed in.
                    console.log(user);
                    // ...
                } else {
                    // User is signed out.
                    // ...
                }
            });
    });

      </script>

</body>
</html>